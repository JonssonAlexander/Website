<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Styr&Ställ - Evaluating Government Bike Policy Using Unintended API Feature</title>
  <meta name="description" content="Speeding up QP solvers by using a graph neural network graph‑neural‑network‑style proxy gradient  and a linear‑algebra trick"/>
  
  <link rel="icon" href="favicon.png" />
  <!-- MathJax for equations (works offline if you self‑host); safe to remove if you export equations as images -->
  <script async id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    /* ------- Minimal reset ------- */
    *,*::before,*::after{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font:16px/1.6 ui-sans-serif,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";color:#0f0f10;background:#fff}
    img{max-width:100%;display:block;height:auto}
    a{color:inherit}
    :root{
      --max: 1080px;          /* content max width */
      --gutter: clamp(16px, 4vw, 32px);
      --radius: 16px;
      --shadow: 0 10px 30px rgba(0,0,0,.08);
      --border: 1px solid rgba(0,0,0,.08);
      --accent: #111;         /* tweak if you want a color pop */
      --muted: #6b7280;
    }

    /* ------- Layout ------- */
    .wrap{max-width:var(--max);margin:0 auto;padding:0 var(--gutter)}
    header.site{padding:20vh var(--gutter) 10vh;position:relative}
    header.site h1{font-size:clamp(32px,7vw,64px);line-height:1.05;margin:0 0 .6rem;font-weight:700;letter-spacing:-.02em}
    .lede{font-size:clamp(18px,2.4vw,22px);color:var(--muted);max-width:70ch;margin:0}
    .back{display:none}
    /* Always-visible back button, same behavior as index site-name */
    .back-fixed{position:fixed;top:16px;left:16px;z-index:10000;color:#fafafa;text-decoration:none;font-family:"BasisGrotesque-Regular",sans-serif;font-size:.888rem;letter-spacing:.02em;mix-blend-mode:exclusion;padding:4px 6px}
    .back-fixed:focus{outline:2px solid #ffd300;outline-offset:2px}
    @media (max-width:543.98px){.back-fixed{top:12px;left:12px;font-size:.777rem}}

    /* sticky section index like Erik Jonsson’s numbered sections */
    nav.toc{position:sticky;top:0;background:linear-gradient(#fff,rgba(255,255,255,.85));backdrop-filter:saturate(150%) blur(6px);border-bottom:var(--border);z-index:10}
    nav.toc .wrap{display:flex;gap:1rem;overflow:auto;scrollbar-width:none}
    nav.toc .wrap::-webkit-scrollbar{display:none}
    nav.toc a{display:flex;align-items:center;gap:.6rem;padding:1rem .75rem;text-decoration:none;white-space:nowrap;border-bottom:2px solid transparent}
    nav.toc a:is(:hover,:focus){border-color:#000}
    nav.toc a span.num{display:inline-grid;place-items:center;width:1.7rem;height:1.7rem;border-radius:50%;border:1px solid rgba(0,0,0,.15);font-size:.9rem}

    main section{padding:10vh 0;border-bottom:var(--border)}
    main section:last-of-type{border-bottom:none}

    /* ------- Typography helpers ------- */
    h2.section-title{font-size:clamp(22px,3.5vw,32px);letter-spacing:-.01em;margin:0 0 1rem}
    .eyebrow{display:flex;align-items:center;gap:.6rem;color:var(--muted);text-transform:uppercase;font-size:.8rem;letter-spacing:.12em}
    .eyebrow .dot{width:6px;height:6px;border-radius:50%;background:#000;opacity:.3}
    .kicker{color:var(--muted)}

    /* ------- Figures / images ------- */
    figure{margin:2rem 0;border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);background:#f8f8f8;border:var(--border)}
    figure.nochrome{border:none;box-shadow:none;background:transparent}
    figcaption{padding:.75rem 1rem;color:var(--muted);font-size:.9rem}

    /* full‑bleed image (edge‑to‑edge like the reference) */
    .full-bleed{width:100vw;margin-left:calc(50% - 50vw)}
    .full-bleed img{width:100%;height:clamp(40vh,70vh,84vh);object-fit:cover}

    /* hero plot pairing */
    .hero-plot{padding:clamp(24px,4vw,48px);background:#f8f8f8;border-radius:var(--radius);box-shadow:var(--shadow);border:var(--border)}
    .hero-plot-grid{display:grid;gap:clamp(16px,3vw,32px);grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}
    .hero-card{background:#fff;border-radius:var(--radius);box-shadow:var(--shadow);padding:clamp(16px,3vw,24px);display:flex;flex-direction:column;align-items:center}
    .hero-card img{width:100%;height:auto!important;object-fit:contain!important;margin:0}
    .hero-card iframe.map-frame{width:100%;aspect-ratio:16/9;border:none;border-radius:var(--radius);box-shadow:var(--shadow);margin:0}
    .hero-card p{margin-top:.75rem;font-size:.9rem;color:var(--muted);text-align:center}
    .hero-plot figcaption{margin-top:clamp(18px,2vw,32px);text-align:center}
    .hero-plot img{height:auto!important;object-fit:contain!important}

    /* simple responsive grids for multiple figures */
    .grid{display:grid;gap:clamp(12px,2vw,20px)}
    .grid.cols-2{grid-template-columns:1fr 1fr}
    .grid.cols-3{grid-template-columns:1fr 1fr 1fr}
    @media (max-width:900px){.grid.cols-2,.grid.cols-3{grid-template-columns:1fr}}

    /* ------- Code / math blocks ------- */
    pre{padding:1rem;border-radius:12px;background:#0f0f10;color:#f1f5f9;overflow:auto}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}

    /* ------- Reveal on scroll ------- */
    .reveal{opacity:0;transform:translateY(12px);transition:opacity .6s ease,transform .6s ease}
    .reveal.in{opacity:1;transform:none}

    /* ------- Lightbox using <dialog> ------- */
    dialog#lightbox{padding:0;border:none;border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.35)}
    dialog#lightbox::backdrop{background:rgba(0,0,0,.65)}
    .lightbox-img{max-width:90vw;max-height:85vh;display:block}
    .lb-close{position:absolute;inset:10px 14px auto auto;border:none;background:#fff;border-radius:999px;width:40px;height:40px;box-shadow:var(--shadow);font-weight:700;cursor:pointer}

    footer{padding:12vh var(--gutter) 16vh;color:var(--muted)}

    /* ------- Proof hover subpage ------- */
    .proof-trigger{color:var(--accent); text-decoration:underline; text-decoration-thickness: from-font; cursor:pointer}
    .proof-box{position:fixed; left:50%; top:8vh; transform:translateX(-50%) translateY(-8px); width:min(1100px,92vw); max-height:80vh; overflow:auto; background:#fff; border:var(--border); border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,.25); padding:18px; opacity:0; pointer-events:none; transition:opacity .25s ease, transform .25s ease; z-index:10001}
    .proof-box.open{opacity:1; pointer-events:auto; transform:translateX(-50%) translateY(0)}
    .proof-trigger:hover + .proof-box{opacity:1; pointer-events:auto; transform:translateX(-50%) translateY(0)}
    .proof-close{position:sticky; top:0; margin:-6px -6px 12px auto; display:inline-block; border:none; background:#fff; border-radius:999px; width:36px; height:36px; box-shadow:var(--shadow); font-weight:700; cursor:pointer}
    .proof-box > *{margin-left:0; margin-right:0}
  </style>
</head>
<body>
  <a class="back-fixed" href="../../index.html"><span>←</span> Back to projects</a>
  <header class="site wrap">
    <h1>Styr&Ställ - Evaluating Government Bike Policy Using Unintended API Feature</h1>
    <p class="lede"> Using an unintended API feature to infer public bike ride routes and evaluating time policy using Markov Chains.</p>
  </header>

  <!-- Sticky section index (numbers echo the Erik Jonsson vibe) -->
  <nav class="toc">
    <div class="wrap">
      <a href="#tldr"><span class="num">1</span> TL;DR</a>
      <a href="#overview"><span class="num">2</span> Problem Overview</a>
      <a href="#inference"><span class="num">3</span> Bike Route Inference Logic</a>
      <a href="#routeactivity"><span class="num">4</span> Route & Activity Map</a>
      <a href="#markov"><span class="num">5</span> Markov Chain</a>
      <a href="#driver"><span class="num">6</span> Driver Detection</a>
      <a href="#conclusion"><span class="num">7</span> Conclusion</a>
      <a href="#api"><span class="num">8</span> Comparing APIs</a>
    </div>
  </nav>

  <main>
    <!-- HERO full‑bleed image -->
    <section id="hero" class="full-bleed">
      <figure class="hero-plot">
        <div class="hero-plot-grid">
          <div class="hero-card">
            <iframe class="map-frame" src="../../wp-content/uploads/styr_stall/station_activity_map.html" title="Station activity map" loading="lazy"></iframe>
            <p>Bike activity in Gothenburg</p>
          </div>
          <div class="hero-card">
            <iframe class="map-frame" src="../../wp-content/uploads/styr_stall/routes_map.html" title="Inferred bike routes" loading="lazy"></iframe>
            <p>Inferred bike routes</p>
          </div>
        </div>
        <figcaption>Bike ride activity for a whole day (left) and infered bike routes graph (right)</figcaption>
      </figure>
    </section>

    <section id="tldr" class="wrap">
      <div class="eyebrow"><span class="dot"></span><span>Summary</span></div>
      <h2 class="section-title">1 — TL;DR</h2>
      <p><strong>Why:</strong>I became annoyed that the municipality spent obsurd amounts of money on a survey they could've answered using their own data... So I did the job for them.</p>
      <p><strong>Idea:</strong> Use Nextbike API's Bike station information to deduce rides and evaluating free usage time for subscribers . </p>
      <ul>
        <li><strong>Trick:</strong> Fetching the Nextbike API's Bike station information with a high enough frequency let us know where a bike went. </li>
        <li><strong>Implications:</strong> This lets us create a Markov Chain of the city bike system and thus evaluate the free ride policy.  </li>


      </ul>
    </section>

    <section id="benchmark" class="wrap">
      <div class="eyebrow"><span class="dot"></span><span>Context</span></div>
      <h2 class="section-title">2 — Problem Overview</h2>
      <p class="kicker"></p>
      <div class="grid cols-2 reveal">
        <!-- Replace the images below with your actual workflow charts -->
        <figure>
          <img class="zoomable" src="images/workflow_qp.png" alt="" loading="lazy" />
          <figcaption>.</figcaption>
        </figure>
        <figure>
          <img class="zoomable" src="images/workflow_proxy.png" alt="" loading="lazy" />
          <figcaption></figcaption>
        </figure>
      </div>
    </section>

    <section id="overview" class="wrap">
      <div class="eyebrow"><span class="dot"></span><span>Setup</span></div>
      <h2 class="section-title">3 — Bike Route Inference Logic</h2>
      <p> </p>
      <div class="grid cols-2 reveal">
        <!-- Replace the images below with your actual workflow charts -->
        <figure>
          <img class="zoomable" src="images/workflow_qp.png" alt="label" loading="lazy" />
          <figcaption>Sa.</figcaption>
        </figure>
        <figure>
          <img class="zoomable" src="images/workflow_proxy.png" alt="label" loading="lazy" />
          <figcaption>s.</figcaption>
        </figure>
      </div>
    </section>

<section id="faster" class="wrap">
  <div class="eyebrow"><span class="dot"></span><span>Derivation</span></div>
<h2 class="section-title">4 — Route & Activity Map</h2>

<p class="kicker"><strong>a </strong>

    </section>

    <section id="gnn" class="wrap">
      <div class="eyebrow"><span class="dot"></span><span>Analogy</span></div>
      <h2 class="section-title">5 — Markov Chain</h2>
      <p> Note that I ended up using a Haversine distance instead of hooking it up to the Google Maps API for exact distances and traveling time. This was mainly because of two reasons. 1. the distances we are looking at are fairly small so an approximation should work pretty well and 2. The Google Maps API is not free. </p>
    </section>

    <section id="sim" class="wrap">
      <div class="eyebrow"><span class="dot"></span><span>Results</span></div>
      <h2 class="section-title">6 — Driver Detection</h2>
      <p></p> 
      <figure class="full-bleed reveal">
        <img class="zoomable" src="image.png" alt="label" loading="lazy" />
        <figcaption>Runtime ↔︎ error trade-off.</figcaption>
      </figure>
    </section>

    <section id="conclusion" class="wrap">
      <div class="eyebrow"><span class="dot"></span><span>Wrap‑up</span></div>
      <h2 class="section-title">7 — Conclusion</h2>
      <ul>
        <li></li>
        <li></li>
        <li></li>
      </ul>
    </section>

    <section id="conclusion" class="wrap">
      <div class="eyebrow"><span class="dot"></span><span>Comp API</span></div>
      <h2 class="section-title">8 — Comparing APIs</h2>
      <ul>
        <li></li>
        <li></li>
        <li></li>
      </ul>
    </section>
  </main>

  <footer class="wrap">
    <p>© Your Name — <a href="#">Download PDF</a> · <a href="#">Contact</a></p>
  </footer>

  <!-- Lightbox dialog (click any .zoomable image) -->
  <dialog id="lightbox">
    <button class="lb-close" aria-label="Close">×</button>
    <img class="lightbox-img" src="image.png" alt="Expanded view" />
  </dialog>

  <script>
    // Reveal on scroll
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{ if(e.isIntersecting) e.target.classList.add('in');});
    }, {threshold: .08});
    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

    // Simple lightbox using <dialog>
    const lb = document.getElementById('lightbox');
    const lbImg = lb.querySelector('.lightbox-img');
    const closeLb = ()=> lb.close();
    document.addEventListener('click', (e)=>{
      const t = e.target.closest('.zoomable');
      if(!t) return;
      e.preventDefault();
      lbImg.src = t.currentSrc || t.src;
      lb.showModal();
    });
    lb.querySelector('.lb-close').addEventListener('click', closeLb);
    lb.addEventListener('click', (e)=>{ if(e.target === lb) closeLb(); });

    // Proof hover/click interactions (works for hover and touch)
    (function(){
      const trigger = document.querySelector('.proof-trigger');
      const box = document.getElementById('proof-box');
      const close = box ? box.querySelector('.proof-close') : null;
      if(!trigger || !box) return;
      const setOpen = (open)=>{
        box.classList.toggle('open', open);
        trigger.setAttribute('aria-expanded', String(!!open));
        box.setAttribute('aria-hidden', String(!open));
      };
      trigger.addEventListener('click', (e)=>{ e.preventDefault(); setOpen(!box.classList.contains('open')); });
      trigger.addEventListener('mouseenter', ()=> setOpen(true));
      box.addEventListener('mouseleave', ()=> setOpen(false));
      if(close) close.addEventListener('click', ()=> setOpen(false));
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') setOpen(false); });
    })();
  </script>
</body>
</html>
